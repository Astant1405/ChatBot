## ChatBot

Проект представляет из себя чат для отправки сообщений llm и получения от неё ответов. В качестве llm выбрана mistral 7B, но может быть выбрана любая(исходя из целей и доступного железа).

Технологии и стек:

- Java 17+

- Spring Boot (Web, Data JPA, Validation, Security)

- Junit, Spring Test

- PostgreSQL

- Apache Kafka

- Docker

- HTML/CSS/JS


# Схема проекта:

                     ┌────────────────────┐
                     │  Пользователь      │
                     │  (браузер)         │
                     │http://localhost:8080│
                     └──────────┬─────────┘
                                │
                                ▼
            ┌──────────────────────────────────────────┐
            │       service1 :8080 (Spring Boot)       │
            │──────────────────────────────────────────│
            │  - REST API                              │
            │  - JWT + Яндекс OAuth                    │
            │  - PostgreSQL (через db:5432)            │
            │  - Kafka Producer (→ kafka:9092)         │
            │  - REST endpoint /api/response           │
            │  - Фронт (resources/static)              │
            └──────────┬───────────────────────────────┘
                       │
            (Kafka msg)│
                       ▼
            ┌──────────────────────────────────────────┐
            │       service2 :8081 (Spring Boot)       │
            │──────────────────────────────────────────│
            │  - Kafka Consumer (← kafka:9092)         │
            │  - Обработка LLM-запроса (→ ollama:11434)│
            │  - REST POST → service1/api/response     │
            │  - Unit + Integration tests              │
            └──────────┬───────────────────────────────┘
                       │
                       ▼
            ┌──────────────────────┐
            │    ollama :11434     │
            │   LLM сервер (API)   │
            └──────────────────────┘
                       ▲
                       │
         ┌─────────────┴─────────────────┐
         │                               │
┌─────────────────────┐       ┌──────────────────────┐
│  kafka :9092        │       │  postgres :5432      │
│  брокер сообщений   │       │  база данных         │
│  (без Zookeeper)    │       │  (ChatBot, users)    │
└─────────────────────┘       └──────────────────────┘


# Схема контейнеризации:

┌──────────────────────────────────────────────┐
│              Docker Compose Stack            │
│──────────────────────────────────────────────│
│  Сеть: backend                               │
│  Контейнеры:                                 │
│   • service1 (Spring Boot + фронт)           │
│   • service2 (Spring Boot + LLM)             │
│   • kafka (broker сообщений)                 │
│   • postgres (база данных пользователей)     │
│   • ollama (LLM API сервер)                  │
└──────────────────────────────────────────────┘


# Демонстрация

Переходим в корневую папку, собираем и запускаем контейнеры с помощью команды docker compose up --build:

![alt text](<Снимок экрана от 2025-10-07 20-41-23.png>)

Подождём пока всё соберётся, проверим что все контейнеры поднялись:

![alt text](<Снимок экрана от 2025-10-07 20-42-12.png>)

Откроем стартовую страницу:

![alt text](<Снимок экрана от 2025-10-07 20-49-14.png>)

Далее выберем например регистрацию через Яндекс:

![alt text](<Снимок экрана от 2025-10-07 20-49-30.png>)

Далее вводим свои данные:

![alt text](<Снимок экрана от 2025-10-07 20-50-40.png>)

Успешно авторизируемся и заходим в чат:

![alt text](<Снимок экрана от 2025-10-07 21-02-15.png>)

![alt text](<Снимок экрана от 2025-10-07 21-04-38.png>)

Откроем логи кафки и заметим что сообщения проходят через неё:

![alt text](<Снимок экрана от 2025-10-07 21-05-34.png>)


# Тесты 

Тест 1 - проверяет, что LlmService корректно взаимодействует с Ollama API и публикует результат в Kafka:

![alt text](<Снимок экрана от 2025-10-07 21-10-57.png>)

Тест 2 - проверяет, что KafkaMessageListener корректно обрабатывает входящее Kafka-сообщение, вызывает LLM, и возвращает ответ через сервис.

![alt text](<Снимок экрана от 2025-10-07 21-12-42.png>)

Оба теста запускаются локально.